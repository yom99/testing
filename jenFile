pipeline {
    agent any

    stages {
        stage('initial') {
            steps {
               git 'https://github.com/yom99/testing.git'
            }
        }
         stage('install npm') {
            steps {
               sh 'npm install'
            }
        }
         stage('start server') {
            steps {
               sh 'npm start &'
               sh 'npx wait-port localhost:8080'
              }
        }
        
        stage('run') {
            steps {
               sh 'npm run cypress:open1'
              }
              
        }
        
        
        stage('Parallel Stage') {
            when {
                branch 'master'
            }
            failFast true
            parallel {
                stage('Branch A') {
                    agent {
                        label "for-branch-a"
                    }
                    steps {
                        echo "On Branch A"
                    }
                }
                stage('Branch B') {
                    agent {
                        label "for-branch-b"
                    }
                    steps {
                        echo "On Branch B"
                    }
                }
        
       
        
      }
}
